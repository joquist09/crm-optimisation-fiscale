{% extends 'core/base.html' %}

{% block title %}{{ societe.nom }} - CRM OF{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'societe_list' %}">Sociétés</a></li>
        <li class="breadcrumb-item active">{{ societe.nom }}</li>
    </ol>
</nav>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="page-title">
        <i class="fas fa-building"></i> {{ societe.nom }}
    </h1>
    <div>
        <a href="{% url 'societe_edit' societe.pk %}" class="btn btn-warning">
            <i class="fas fa-edit me-2"></i> Modifier
        </a>
        <a href="{% url 'client_detail' societe.client.pk %}" class="btn btn-primary">
            <i class="fas fa-user me-2"></i> Voir le client
        </a>
    </div>
</div>

<div class="row">
    <!-- Informations générales -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-info-circle me-2"></i> Informations générales
            </div>
            <div class="card-body">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Nom:</td>
                        <td>{{ societe.nom }}</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Type:</td>
                        <td><span class="badge bg-primary">{{ societe.get_type_societe_display }}</span></td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Client:</td>
                        <td>
                            <a href="{% url 'client_detail' societe.client.pk %}" class="text-decoration-none">
                                {{ societe.client.nom }} {{ societe.client.prenom }}
                            </a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <!-- Informations financières -->
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-dollar-sign me-2"></i> Informations financières
            </div>
            <div class="card-body">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Revenus:</td>
                        <td>{{ societe.revenus|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Dépenses déductibles:</td>
                        <td>{{ societe.depenses_deductibles|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Dépenses non déductibles:</td>
                        <td>{{ societe.depenses_non_deductibles|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Salaire client:</td>
                        <td>{{ societe.salaire_client|floatformat:2 }} $</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Détails selon le type -->
{% if societe.type_societe == 'operante' %}
<div class="card mt-4">
    <div class="card-header">
        <i class="fas fa-cogs me-2"></i> Détails société opérante
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Solde CRTG opérante:</td>
                        <td>{{ societe.solde_crtg_operante|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">DPA fédérale:</td>
                        <td>{{ societe.dpa_federale|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">DPA provinciale:</td>
                        <td>{{ societe.dpa_provinciale|floatformat:2 }} $</td>
                    </tr>
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Pourcentage bénéfices investis:</td>
                        <td>{{ societe.pourcentage_benefices_investis|floatformat:2 }} %</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Salaire conjoint:</td>
                        <td>{{ societe.salaire_conjoint|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Salaire employé:</td>
                        <td>{{ societe.salaire_employe|floatformat:2 }} $</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
{% elif societe.type_societe == 'gestion' %}
<div class="card mt-4">
    <div class="card-header">
        <i class="fas fa-chart-line me-2"></i> Détails société de gestion
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Solde IMRTD non déterminés:</td>
                        <td>{{ societe.solde_imrtd_non_determines|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Solde IMRTD déterminés:</td>
                        <td>{{ societe.solde_imrtd_determines|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Solde CDC:</td>
                        <td>{{ societe.solde_cdc|floatformat:2 }} $</td>
                    </tr>
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td class="fw-bold">Solde CRTG gestion:</td>
                        <td>{{ societe.solde_crtg_gestion|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Capital versé:</td>
                        <td>{{ societe.capital_verse|floatformat:2 }} $</td>
                    </tr>
                    <tr>
                        <td class="fw-bold">Actions dividendes discrétionnaires:</td>
                        <td>{{ societe.actions_dividendes_discretionnaires|floatformat:2 }} $</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}